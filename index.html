<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Verb Dictionary</title>
  <link rel="manifest" href="manifest.json">
  <script src="verbs.js"></script>
  <style>
    /* General Styles */
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      margin: 0;
      padding: 0;
      transition: background-color 0.3s, color 0.3s;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 10px 10px 80px 10px;
    }
    .header {
      position: sticky;
      top: 0;
      z-index: 100;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 10px;
      background: linear-gradient(135deg, #007bff, #00d4ff);
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
      margin-bottom: 15px;
      animation: slideIn 0.5s ease-in-out;
    }
    h1 {
      font-size: 1.8em;
      margin: 0;
      color: white;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
      font-weight: 600;
    }
    select {
      padding: 8px;
      font-size: 0.9em;
      border-radius: 5px;
      border: none;
      cursor: pointer;
      background-color: rgba(255, 255, 255, 0.9);
      transition: background-color 0.3s, transform 0.2s;
      width: 100%;
      max-width: 200px;
    }
    select:hover {
      background-color: #fff;
      transform: scale(1.05);
    }
    button.theme-toggle {
      position: absolute;
      top: 15px;
      right: 15px;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: none;
      background-color: rgba(255, 255, 255, 0.9);
      cursor: pointer;
      font-size: 1.2em;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background-color 0.3s, transform 0.2s;
    }
    button.theme-toggle:hover {
      background-color: #fff;
      transform: scale(1.1);
    }
    @keyframes slideIn {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    body.light {
      background-color: #f4f4f9;
      color: #333;
    }
    body.dark {
      background-color: #222;
      color: #e0e0e0;
    }
    body.dark .tab-content, body.dark .section, body.dark .sticky-section-header, body.dark .section-content {
      background-color: #2a2a2a;
    }
    body.dark input, body.dark select {
      background-color: #444;
      color: #e0e0e0;
      border: 1px solid #666;
    }
    body.dark table {
      background-color: #2a2a2a;
      color: #e0e0e0;
    }
    body.dark th, body.dark td {
      border: 1px solid #666;
      color: #e0e0e0;
    }
    body.dark th {
      background-color: #1a3c6e;
    }
    body.dark tr:nth-child(even) {
      background-color: #333;
    }
    body.dark .header {
      background: linear-gradient(135deg, #1a3c6e, #4a90e2);
    }
    body.dark select, body.dark button.theme-toggle {
      background-color: rgba(255, 255, 255, 0.2);
      color: #e0e0e0;
    }
    body.dark select:hover, body.dark button.theme-toggle:hover {
      background-color: rgba(255, 255, 255, 0.3);
    }
    .tabs {
      position: sticky;
      top: 110px;
      z-index: 90;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      margin-bottom: 15px;
      background-color: inherit;
    }
    .tab-group {
      display: flex;
      gap: 8px;
      overflow-x: auto;
      white-space: nowrap;
      -webkit-overflow-scrolling: touch;
    }
    .tab {
      padding: 8px 15px;
      background-color: #ddd;
      border-radius: 5px 5px 0 0;
      cursor: pointer;
      transition: background-color 0.3s;
      flex: 0 0 auto;
      font-size: 0.9em;
    }
    .tab.active {
      background-color: #007bff;
      color: white;
    }
    .tab:hover {
      background-color: #bbb;
    }
    body.dark .tab {
      background-color: #444;
    }
    body.dark .tab:hover {
      background-color: #555;
    }
    body.dark .tab.active {
      background-color: #4a90e2;
    }
    .search-section {
      display: flex;
      align-items: center;
    }
    .search-container {
      display: flex;
      gap: 10px;
      align-items: center;
    }
    .search-container.hidden {
      display: none;
    }
    input[type="text"] {
      padding: 8px;
      width: 100%;
      max-width: 250px;
      border-radius: 5px;
      border: 1px solid #ddd;
      font-size: 0.9em;
    }
    .search-container button {
      padding: 8px 15px;
      font-size: 0.9em;
      border-radius: 5px;
      border: none;
      background-color: #007bff;
      color: white;
      cursor: pointer;
    }
    .search-container button:hover {
      background-color: #0056b3;
    }
    body.dark .search-container button {
      background-color: #4a90e2;
    }
    body.dark .search-container button:hover {
      background-color: #357abd;
    }
    .error-message {
      color: #d32f2f;
      font-size: 0.9em;
      margin-top: 5px;
      display: none;
    }
    body.dark .error-message {
      color: #ef5350;
    }
    .tab-content {
      background-color: white;
      padding: 15px;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      animation: fadeIn 0.5s ease-in-out;
    }
    .tab-content.hidden {
      display: none;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .section {
      background-color: white;
      padding: 12px;
      border-radius: 5px;
      margin-bottom: 12px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .sticky-section-header {
      position: sticky;
      top: 90px;
      z-index: 80;
      background-color: inherit;
    }
    .section-header {
      font-size: 1.1em;
      font-weight: 600;
      margin-bottom: 10px;
      color: #333;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    body.dark .section-header {
      color: #e0e0e0;
    }
    .section-content {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .section-item {
      padding: 12px;
      border-bottom: 1px solid #ddd;
      border-radius: 5px;
      background-color: #fafafa;
      cursor: pointer;
    }
    body.dark .section-item {
      border-bottom: 1px solid #666;
      background-color: #333;
    }
    .section-item:hover {
      background-color: #e0e0e0;
    }
    body.dark .section-item:hover {
      background-color: #444;
    }
    .section-item span {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.9em;
    }
    .section-item .action-btn {
      cursor: pointer;
      font-size: 1em;
    }
    .section-search-container {
      display: none;
      flex-direction: column;
      align-items: stretch;
      margin-top: 10px;
    }
    .section-search-container.active {
      display: flex;
    }
    .section-search-container input {
      max-width: 100%;
      box-sizing: border-box;
    }
    .section-search-container button {
      font-size: 0.85em;
      padding: 8px;
      width: 100%;
      max-width: 100%;
      border-radius: 5px;
    }
    button.search-toggle {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      border: none;
      background-color: #007bff;
      color: white;
      cursor: pointer;
      font-size: 1em;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background-color 0.3s, transform 0.2s;
    }
    button.search-toggle:hover {
      background-color: #0056b3;
      transform: scale(1.1);
    }
    body.dark button.search-toggle {
      background-color: #4a90e2;
    }
    body.dar k button.search-toggle:hover {
      background-color: #357abd;
    }
    .table-container {
      overflow-x: auto;
      overflow-y: auto;
      max-height: 60vh;
      -webkit-overflow-scrolling: touch;
    }
    table {
      width: 100%;
      min-width: 600px;
      border-collapse: collapse;
      background-color: white;
    }
    th, td {
      padding: 8px;
      text-align: left;
      border: 1px solid #ddd;
      color: #333;
      font-size: 0.9em;
    }
    th {
      background-color: #007bff;
      color: white;
      position: sticky;
      top: 0;
      z-index: 10;
    }
    tr:nth-child(even) {
      background-color: #f9f9f9;
    }
    tr.clickable:hover {
      background-color: #e0e0e0;
      cursor: pointer;
    }
    body.dark tr.clickable:hover {
      background-color: #444;
    }
    .action-btn {
      cursor: pointer;
      font-size: 1em;
      margin-right: 8px;
    }
    .starred {
      color: gold;
    }
    .translate-btn {
      font-size: 0.8em;
      padding: 5px 10px;
      margin: 5px;
      border-radius: 5px;
      background-color: #28a745;
      color: white;
      text-decoration: none;
      display: inline-block;
    }
    .translate-btn:hover {
      background-color: #218838;
    }
    body.dark .translate-btn {
      background-color: #2ecc71;
    }
    body.dark .translate-btn:hover {
      background-color: #27ae60;
    }
    .save-verb-container {
      margin-bottom: 15px;
      display: flex;
      gap: 10px;
      align-items: center;
    }
    .save-verb-container button {
      padding: 8px 15px;
      font-size: 0.9em;
      border-radius: 5px;
      border: none;
      background-color: #007bff;
      color: white;
      cursor: pointer;
    }
    .save-verb-container button:hover {
      background-color: #0056b3;
    }
    body.dark .save-verb-container button {
      background-color: #4a90e2;
    }
    body.dark .save-verb-container button:hover {
      background-color: #357abd;
    }
    footer {
      position: fixed;
      bottom: 0;
      width: 100%;
      text-align: center;
      padding: 15px;
      background-color: #f4f4f9;
      color: #333;
      font-size: 0.9em;
      border-radius: 0;
      box-shadow: 0 -2px 5px rgba(0,0,0,0.1);
      z-index: 100;
    }
    body.dark footer {
      background-color: #2a2a2a;
      color: #e0e0e0;
    }
    @media (max-width: 600px) {
      .container {
        padding-bottom: 80px;
      }
      .header {
        align-items: center;
        padding: 10px;
      }
      h1 {
        font-size: 1.4em;
        text-align: center;
      }
      select {
        max-width: 180px;
        font-size: 0.85em;
      }
      button.theme-toggle {
        top: 10px;
        right: 10px;
        width: 35px;
        height: 35px;
        font-size: 1em;
      }
      .tabs {
        flex-direction: column;
        align-items: stretch;
        gap: 5px;
        padding: 8px;
        background-color: #f4f4f9;
        border-radius: 5px;
        top: 90px;
      }
      body.dark .tabs {
        background-color: #2a2a2a;
      }
      .tab-group {
        gap: 5px;
        justify-content: space-around;
      }
      .tab {
        font-size: 0.85em;
        padding: 8px 12px;
        flex: 1;
        text-align: center;
        border-radius: 5px;
        touch-action: manipulation;
      }
      .search-section {
        display: none;
      }
      .tab-content {
        padding: 10px;
      }
      .table-container {
        display: none;
      }
      .section {
        display: block;
      }
      .save-verb-container {
        flex-direction: column;
        align-items: stretch;
      }
      .save-verb-container button {
        font-size: 0.85em;
        padding: 8px;
        width: 100%;
        max-width: 100%;
      }
      footer {
        font-size: 0.85em;
        padding: 10px;
      }
    }
    @media (min-width: 601px) {
      .header {
        align-items: flex-start;
      }
      h1 {
        text-align: left;
      }
      .section {
        display: none;
      }
      .table-container {
        display: block;
      }
      .sticky-section-header {
        display: none;
      }
    }
  </style>
</head>
<body class="light">
  <div class="container">
    <div class="header">
      <h1>Verb Dictionary App</h1>
      <select id="language">
        <option value="en">English + Hindi + Assamese</option>
        <option value="en-only">Verbs Only</option>
        <option value="en-hi">English + Hindi</option>
        <option value="en-as">English + Assamese</option>
      </select>
      <button class="theme-toggle" onclick="toggleTheme()">🌙</button>
    </div>
    <div class="tabs">
      <div class="tab-group">
        <div class="tab active" onclick="showTab('verbs')">Verbs (A–Z)</div>
        <div class="tab" onclick="showTab('forms')">Verb Forms</div>
        <div class="tab" onclick="showTab('starred')">Starred Verbs</div>
        <div class="tab" onclick="showTab('saved')">Saved Verbs</div>
      </div>
      <div class="search-section">
        <div id="verbs-search" class="search-container">
          <input type="text" id="search-verbs" placeholder="Search verbs..." onkeypress="if(event.keyCode===13)searchVerbs()">
          <button onclick="searchVerbs()">Search</button>
          <div id="verbs-error" class="error-message"></div>
        </div>
        <div id="forms-search" class="search-container hidden">
          <input type="text" id="search-forms" placeholder="Search verb forms..." onkeypress="if(event.keyCode===13)searchForms()">
          <button onclick="searchForms()">Search</button>
          <div id="forms-error" class="error-message"></div>
        </div>
      </div>
    </div>
    <div id="verbs" class="tab-content">
      <div class="section" id="verbs-section">
        <div class="sticky-section-header">
          <div class="section-header">Verbs (A–Z) with Meanings <button class="search-toggle" onclick="toggleSearch('verbs')">🔍</button></div>
          <div id="verbs-section-search" class="section-search-container">
            <input type="text" id="search-verbs-mobile" placeholder="Search verbs..." onkeypress="if(event.keyCode===13)searchVerbs()">
            <button onclick="searchVerbs()">Search</button>
            <div id="verbs-error-mobile" class="error-message"></div>
          </div>
        </div>
        <div class="section-content"></div>
      </div>
      <div class="table-container">
        <table id="verbs-table">
          <thead>
            <tr>
              <th>Verb</th>
              <th class="meaning-col">Meaning</th>
              <th class="hindi-col">Hindi</th>
              <th class="assamese-col">Assamese</th>
              <th>🔊</th>
              <th>★</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
    <div id="forms" class="tab-content hidden">
      <div class="section" id="forms-section">
        <div class="sticky-section-header">
          <div class="section-header">Verb Forms <button class="search-toggle" onclick="toggleSearch('forms')">🔍</button></div>
          <div id="forms-section-search" class="section-search-container">
            <input type="text" id="search-forms-mobile" placeholder="Search verb forms..." onkeypress="if(event.keyCode===13)searchForms()">
            <button onclick="searchForms()">Search</button>
            <div id="forms-error-mobile" class="error-message"></div>
          </div>
        </div>
        <div class="section-content"></div>
      </div>
      <div class="table-container">
        <table id="forms-table">
          <thead>
            <tr>
              <th>Present</th>
              <th>Past</th>
              <th>Participle</th>
              <th>🔊</th>
              <th>★</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
    <div id="starred" class="tab-content hidden">
      <div class="section" id="starred-section">
        <div class="sticky-section-header">
          <div class="section-header">Starred Verbs <button class="search-toggle" onclick="toggleSearch('starred')">🔍</button></div>
          <div id="starred-section-search" class="section-search-container">
            <input type="text" id="search-starred-mobile" placeholder="Search starred verbs..." onkeypress="if(event.keyCode===13)searchStarred()">
            <button onclick="searchStarred()">Search</button>
            <div id="starred-error-mobile" class="error-message"></div>
          </div>
        </div>
        <div class="section-content"></div>
      </div>
      <div class="table-container">
        <table id="starred-table">
          <thead>
            <tr>
              <th>Verb</th>
              <th class="meaning-col">Meaning</th>
              <th class="hindi-col">Hindi</th>
              <th class="assamese-col">Assamese</th>
              <th>🔊</th>
              <th>★</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
    <div id="saved" class="tab-content hidden">
      <div class="save-verb-container">
        <input type="text" id="save-verb" placeholder="Enter verb to save..." onkeypress="if(event.keyCode===13)saveVerb()">
        <button onclick="saveVerb()">Save Verb</button>
        <div id="save-error" class="error-message"></div>
      </div>
      <div class="section" id="saved-section">
        <div class="sticky-section-header">
          <div class="section-header">Saved Verbs <button class="search-toggle" onclick="toggleSearch('saved')">🔍</button></div>
          <div id="saved-section-search" class="section-search-container">
            <input type="text" id="search-saved-mobile" placeholder="Search saved verbs..." onkeypress="if(event.keyCode===13)searchSaved()">
            <button onclick="searchSaved()">Search</button>
            <div id="saved-error-mobile" class="error-message"></div>
          </div>
        </div>
        <div class="section-content"></div>
      </div>
      <div class="table-container">
        <table id="saved-table">
          <thead>
            <tr>
              <th>Verb</th>
              <th class="meaning-col">Meaning</th>
              <th class="hindi-col">Hindi</th>
              <th class="assamese-col">Assamese</th>
              <th>🔊</th>
              <th>★</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
    <footer>© All rights reserved Saheb Ali</footer>
  </div>
  <script>
    // Initialize localStorage
    let starredVerbs = JSON.parse(localStorage.getItem('starredVerbs')) || [];
    let savedVerbs = JSON.parse(localStorage.getItem('savedVerbs')) || [];
    let fetchedVerbs = JSON.parse(localStorage.getItem('fetchedVerbs')) || [];
    let currentLanguage = localStorage.getItem('language') || 'en';
    let currentTheme = localStorage.getItem('theme') || 'light';

    // Apply saved theme
    document.body.className = currentTheme;
    document.querySelector('.theme-toggle').innerHTML = currentTheme === 'light' ? '🌙' : '☀️';

    // Populate language dropdown
    const languageSelect = document.getElementById('language');
    languageSelect.value = currentLanguage;
    languageSelect.addEventListener('change', (e) => {
      currentLanguage = e.target.value;
      localStorage.setItem('language', currentLanguage);
      updateColumnVisibility();
      renderTables();
    });

    // Theme Toggle
    function toggleTheme() {
      currentTheme = currentTheme === 'light' ? 'dark' : 'light';
      document.body.className = currentTheme;
      localStorage.setItem('theme', currentTheme);
      document.querySelector('.theme-toggle').innerHTML = currentTheme === 'light' ? '🌙' : '☀️';
    }

    // Update column visibility
    function updateColumnVisibility() {
      const meaningCols = document.querySelectorAll('.meaning-col');
      const hindiCols = document.querySelectorAll('.hindi-col');
      const assameseCols = document.querySelectorAll('.assamese-col');
      meaningCols.forEach(col => col.style.display = currentLanguage === 'en-only' ? 'none' : '');
      hindiCols.forEach(col => col.style.display = (currentLanguage === 'en-only' || currentLanguage === 'en-as') ? 'none' : '');
      assameseCols.forEach(col => col.style.display = (currentLanguage === 'en-only' || currentLanguage === 'en-hi') ? 'none' : '');
    }

    // Get verb forms
    function getVerbForms(verb) {
      const localVerb = verbs.find(v => 
        v.verb.toLowerCase() === verb.toLowerCase() ||
        v.past.toLowerCase() === verb.toLowerCase() ||
        v.participle.toLowerCase() === verb.toLowerCase()
      );
      if (localVerb) {
        return {
          base: localVerb.verb,
          past: localVerb.past,
          participle: localVerb.participle,
          meaning: localVerb.meaning,
          hindi: localVerb.hindi,
          assamese: localVerb.assamese
        };
      }
      const fetchedVerb = fetchedVerbs.find(v => 
        v.verb.toLowerCase() === verb.toLowerCase() ||
        v.past.toLowerCase() === verb.toLowerCase() ||
        v.participle.toLowerCase() === verb.toLowerCase()
      );
      if (fetchedVerb) {
        return {
          base: fetchedVerb.verb,
          past: fetchedVerb.past,
          participle: fetchedVerb.participle,
          meaning: fetchedVerb.meaning,
          hindi: fetchedVerb.hindi,
          assamese: fetchedVerb.assamese
        };
      }
      const base = verb.toLowerCase();
      const past = base.endsWith('e') ? `${base}d` : `${base}ed`;
      return { base, past, participle: past, meaning: null, hindi: null, assamese: null };
    }

    // Fetch verb from DictionaryAPI.dev (for saving only)
    async function fetchVerb(verb, tab) {
      const errorElements = {
        'saved': document.getElementById('save-error'),
        'saved-mobile': document.getElementById('saved-error-mobile')
      };

      const showError = (tab, message) => {
        if (errorElements[tab]) {
          errorElements[tab].textContent = message;
          errorElements[tab].style.display = 'block';
          setTimeout(() => { errorElements[tab].style.display = 'none'; }, 3000);
        }
      };

      const forms = getVerbForms(verb);
      const baseVerb = forms.base;

      try {
        const response = await fetch(`https://api.dictionaryapi.dev/api/v2/entries/en/${baseVerb}`);
        if (!response.ok) throw new Error('Verb not found in online dictionary');
        const data = await response.json();
        const entry = data[0];
        if (!entry) throw new Error('No data returned for verb');

        let meaning = 'No definition available';
        const verbDefinition = entry.meanings.find(m => m.partOfSpeech === 'verb');
        if (verbDefinition && verbDefinition.definitions[0]) {
          meaning = verbDefinition.definitions[0].definition;
        }

        const newVerb = {
          verb: baseVerb,
          past: forms.past,
          participle: forms.participle,
          meaning,
          hindi: null,
          assamese: null,
          isFetched: true
        };

        if (!fetchedVerbs.some(v => v.verb === baseVerb)) {
          fetchedVerbs.push(newVerb);
          localStorage.setItem('fetchedVerbs', JSON.stringify(fetchedVerbs));
        }
        return newVerb;
      } catch (error) {
        showError(tab, error.message);
        return null;
      }
    }

    // Toggle Search Input
    function toggleSearch(tabId) {
      const searchContainer = document.getElementById(`${tabId}-section-search`);
      searchContainer.classList.toggle('active');
    }

    // Tab Switching
    function showTab(tabId) {
      document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
      document.querySelectorAll('.tab-content').forEach(content => content.classList.add('hidden'));
      document.querySelectorAll('.search-container').forEach(container => container.classList.add('hidden'));
      document.querySelectorAll('.section-search-container').forEach(container => container.classList.remove('active'));
      document.querySelector(`[onclick="showTab('${tabId}')"]`).classList.add('active');
      document.getElementById(tabId).classList.remove('hidden');
      if (tabId === 'verbs') {
        document.getElementById('verbs-search').classList.remove('hidden');
      } else if (tabId === 'forms') {
        document.getElementById('forms-search').classList.remove('hidden');
      }
      renderTables();
    }

    // Navigate to Verb Detail Page
    function goToVerbDetail(verb) {
      window.location.href = `verb-detail.html?verb=${encodeURIComponent(verb)}&language=${currentLanguage}&theme=${currentTheme}`;
    }

    // Render Tables
    function renderTables() {
      renderVerbsTable();
      renderFormsTable();
      renderStarredTable();
      renderSavedTable();
      updateColumnVisibility();
    }

    // Render Verbs (A–Z)
    function renderVerbsTable(search = '') {
      const tbody = document.querySelector('#verbs-table tbody');
      const sectionContent = document.querySelector('#verbs-section .section-content');
      const errorElements = [document.getElementById('verbs-error'), document.getElementById('verbs-error-mobile')];
      tbody.innerHTML = '';
      sectionContent.innerHTML = '';

      let displayVerbs = [];
      if (search) {
        search = search.toLowerCase();
        const forms = getVerbForms(search);
        const localVerb = verbs.find(v => v.verb.toLowerCase() === forms.base);
        const fetchedVerb = fetchedVerbs.find(v => v.verb.toLowerCase() === forms.base);
        if (localVerb) {
          displayVerbs = [localVerb];
        } else if (fetchedVerb) {
          displayVerbs = [fetchedVerb];
        } else {
          displayVerbs = [{
            verb: forms.base,
            past: forms.past,
            participle: forms.participle,
            meaning: null,
            hindi: null,
            assamese: null,
            isTemporary: true
          }];
        }
      } else {
        displayVerbs = [...verbs, ...fetchedVerbs];
      }

      if (search && !displayVerbs.length) {
        errorElements.forEach(el => {
          el.textContent = 'No verbs found';
          el.style.display = 'block';
          setTimeout(() => { el.style.display = 'none'; }, 3000);
        });
      }

      displayVerbs.forEach(v => {
        const hasMeaning = v.meaning && v.meaning !== null;
        const hasHindi = v.hindi && v.hindi !== null;
        const hasAssamese = v.assamese && v.assamese !== null;
        const meaningContent = hasMeaning ? v.meaning : `<a class="translate-btn" href="https://www.google.com/search?q=${encodeURIComponent(v.verb + ' meaning')}" target="_blank">Look up Meaning</a>`;
        const hindiContent = hasHindi ? v.hindi : `<a class="translate-btn" href="https://translate.google.co.in/?text=${encodeURIComponent(v.verb)}&sl=en&tl=hi" target="_blank">Translate to Hindi</a>`;
        const assameseContent = hasAssamese ? v.assamese : `<a class="translate-btn" href="https://translate.google.co.in/?text=${encodeURIComponent(v.verb)}&sl=en&tl=as" target="_blank">Translate to Assamese</a>`;

        const row = document.createElement('tr');
        row.className = 'clickable';
        row.onclick = () => goToVerbDetail(v.verb);
        row.innerHTML = `
          <td>${v.verb}</td>
          <td class="meaning-col">${meaningContent}</td>
          <td class="hindi-col">${hindiContent}</td>
          <td class="assamese-col">${assameseContent}</td>
          <td><span class="action-btn" onclick="event.stopPropagation(); speak('${v.verb}')">🔊</span></td>
          <td><span class="action-btn ${starredVerbs.includes(v.verb) ? 'starred' : ''}" onclick="event.stopPropagation(); toggleStar('${v.verb}')">★</span></td>
        `;
        tbody.appendChild(row);
        const item = document.createElement('div');
        item.className = 'section-item';
        item.onclick = () => goToVerbDetail(v.verb);
        item.innerHTML = `
          <span><strong>Verb:</strong> ${v.verb}</span>
          ${currentLanguage === 'en-only' ? '' : `<span><strong>Meaning:</strong> ${meaningContent}</span>`}
          ${currentLanguage === 'en-only' || currentLanguage === 'en-as' ? '' : `<span><strong>Hindi:</strong> ${hindiContent}</span>`}
          ${currentLanguage === 'en-only' || currentLanguage === 'en-hi' ? '' : `<span><strong>Assamese:</strong> ${assameseContent}</span>`}
          <span><span class="action-btn" onclick="event.stopPropagation(); speak('${v.verb}')">🔊</span></span>
          <span><span class="action-btn ${starredVerbs.includes(v.verb) ? 'starred' : ''}" onclick="event.stopPropagation(); toggleStar('${v.verb}')">★</span></span>
        `;
        sectionContent.appendChild(item);
      });
    }

    // Render Verb Forms
    function renderFormsTable(search = '') {
      const tbody = document.querySelector('#forms-table tbody');
      const sectionContent = document.querySelector('#forms-section .section-content');
      const errorElements = [document.getElementById('forms-error'), document.getElementById('forms-error-mobile')];
      tbody.innerHTML = '';
      sectionContent.innerHTML = '';

      let displayVerbs = [];
      if (search) {
        search = search.toLowerCase();
        const forms = getVerbForms(search);
        const localVerb = verbs.find(v => v.verb.toLowerCase() === forms.base);
        const fetchedVerb = fetchedVerbs.find(v => v.verb.toLowerCase() === forms.base);
        if (localVerb) {
          displayVerbs = [localVerb];
        } else if (fetchedVerb) {
          displayVerbs = [fetchedVerb];
        } else {
          const row = document.createElement('tr');
          row.innerHTML = `
            <td colspan="3"><a class="translate-btn" href="https://www.google.com/search?q=${encodeURIComponent(search + ' present past participle verb form')}" target="_blank">Look up Verb Forms</a></td>
            <td></td>
            <td></td>
          `;
          tbody.appendChild(row);
          const item = document.createElement('div');
          item.className = 'section-item';
          item.onclick = () => goToVerbDetail(search);
          item.innerHTML = `
            <span><strong>Verb:</strong> ${search}</span>
            <span><a class="translate-btn" href="https://www.google.com/search?q=${encodeURIComponent(search + ' present past participle verb form')}" target="_blank">Look up Verb Forms</a></span>
          `;
          sectionContent.appendChild(item);
          errorElements.forEach(el => {
            el.textContent = 'No verb forms found in local data';
            el.style.display = 'block';
            setTimeout(() => { el.style.display = 'none'; }, 3000);
          });
          return;
        }
      } else {
        displayVerbs = [...verbs, ...fetchedVerbs];
      }

      displayVerbs.forEach(v => {
        const row = document.createElement('tr');
        row.className = 'clickable';
        row.onclick = () => goToVerbDetail(v.verb);
        row.innerHTML = `
          <td><span class="action-btn" onclick="event.stopPropagation(); speak('${v.verb}')">🔊</span>${v.verb}</td>
          <td><span class="action-btn" onclick="event.stopPropagation(); speak('${v.past}')">🔊</span>${v.past}</td>
          <td><span class="action-btn" onclick="event.stopPropagation(); speak('${v.participle}')">🔊</span>${v.participle}</td>
          <td><span class="action-btn" onclick="event.stopPropagation(); speakAllForms('${v.verb}', '${v.past}', '${v.participle}')">🔊</span></td>
          <td><span class="action-btn ${starredVerbs.includes(v.verb) ? 'starred' : ''}" onclick="event.stopPropagation(); toggleStar('${v.verb}')">★</span></td>
        `;
        tbody.appendChild(row);
        const item = document.createElement('div');
        item.className = 'section-item';
        item.onclick = () => goToVerbDetail(v.verb);
        item.innerHTML = `
          <span><strong>Present:</strong> <span class="action-btn" onclick="event.stopPropagation(); speak('${v.verb}')">🔊</span>${v.verb}</span>
          <span><strong>Past:</strong> <span class="action-btn" onclick="event.stopPropagation(); speak('${v.past}')">🔊</span>${v.past}</span>
          <span><strong>Participle:</strong> <span class="action-btn" onclick="event.stopPropagation(); speak('${v.participle}')">🔊</span>${v.participle}</span>
          <span><span class="action-btn" onclick="event.stopPropagation(); speakAllForms('${v.verb}', '${v.past}', '${v.participle}')">🔊 All</span></span>
          <span><span class="action-btn ${starredVerbs.includes(v.verb) ? 'starred' : ''}" onclick="event.stopPropagation(); toggleStar('${v.verb}')">★</span></span>
        `;
        sectionContent.appendChild(item);
      });
    }

    // Render Starred Verbs
    function renderStarredTable(search = '') {
      const tbody = document.querySelector('#starred-table tbody');
      const sectionContent = document.querySelector('#starred-section .section-content');
      const errorElements = [document.getElementById('starred-error-mobile')];
      tbody.innerHTML = '';
      sectionContent.innerHTML = '';

      let displayVerbs = [...verbs, ...fetchedVerbs].filter(v => starredVerbs.includes(v.verb));
      if (search) {
        search = search.toLowerCase();
        const forms = getVerbForms(search);
        displayVerbs = displayVerbs.filter(v => v.verb.toLowerCase() === forms.base);
      }

      if (search && !displayVerbs.length) {
        errorElements.forEach(el => {
          el.textContent = 'No starred verbs found';
          el.style.display = 'block';
          setTimeout(() => { el.style.display = 'none'; }, 3000);
        });
      }

      displayVerbs.forEach(v => {
        const hasMeaning = v.meaning && v.meaning !== null;
        const hasHindi = v.hindi && v.hindi !== null;
        const hasAssamese = v.assamese && v.assamese !== null;
        const meaningContent = hasMeaning ? v.meaning : `<a class="translate-btn" href="https://www.google.com/search?q=${encodeURIComponent(v.verb + ' meaning')}" target="_blank">Look up Meaning</a>`;
        const hindiContent = hasHindi ? v.hindi : `<a class="translate-btn" href="https://translate.google.co.in/?text=${encodeURIComponent(v.verb)}&sl=en&tl=hi" target="_blank">Translate to Hindi</a>`;
        const assameseContent = hasAssamese ? v.assamese : `<a class="translate-btn" href="https://translate.google.co.in/?text=${encodeURIComponent(v.verb)}&sl=en&tl=as" target="_blank">Translate to Assamese</a>`;

        const row = document.createElement('tr');
        row.className = 'clickable';
        row.onclick = () => goToVerbDetail(v.verb);
        row.innerHTML = `
          <td>${v.verb}</td>
          <td class="meaning-col">${meaningContent}</td>
          <td class="hindi-col">${hindiContent}</td>
          <td class="assamese-col">${assameseContent}</td>
          <td><span class="action-btn" onclick="event.stopPropagation(); speak('${v.verb}')">🔊</span></td>
          <td><span class="action-btn starred" onclick="event.stopPropagation(); toggleStar('${v.verb}')">★</span></td>
        `;
        tbody.appendChild(row);
        const item = document.createElement('div');
        item.className = 'section-item';
        item.onclick = () => goToVerbDetail(v.verb);
        item.innerHTML = `
          <span><strong>Verb:</strong> ${v.verb}</span>
          ${currentLanguage === 'en-only' ? '' : `<span><strong>Meaning:</strong> ${meaningContent}</span>`}
          ${currentLanguage === 'en-only' || currentLanguage === 'en-as' ? '' : `<span><strong>Hindi:</strong> ${hindiContent}</span>`}
          ${currentLanguage === 'en-only' || currentLanguage === 'en-hi' ? '' : `<span><strong>Assamese:</strong> ${assameseContent}</span>`}
          <span><span class="action-btn" onclick="event.stopPropagation(); speak('${v.verb}')">🔊</span></span>
          <span><span class="action-btn starred" onclick="event.stopPropagation(); toggleStar('${v.verb}')">★</span></span>
        `;
        sectionContent.appendChild(item);
      });
    }

    // Render Saved Verbs
    function renderSavedTable(search = '') {
      const tbody = document.querySelector('#saved-table tbody');
      const sectionContent = document.querySelector('#saved-section .section-content');
      const errorElements = [document.getElementById('save-error'), document.getElementById('saved-error-mobile')];
      tbody.innerHTML = '';
      sectionContent.innerHTML = '';

      let displayVerbs = [...verbs, ...fetchedVerbs].filter(v => savedVerbs.includes(v.verb));
      if (search) {
        search = search.toLowerCase();
        const forms = getVerbForms(search);
        displayVerbs = displayVerbs.filter(v => v.verb.toLowerCase() === forms.base);
      }

      if (search && !displayVerbs.length) {
        errorElements.forEach(el => {
          el.textContent = 'No saved verbs found';
          el.style.display = 'block';
          setTimeout(() => { el.style.display = 'none'; }, 3000);
        });
      }

      displayVerbs.forEach(v => {
        const hasMeaning = v.meaning && v.meaning !== null;
        const hasHindi = v.hindi && v.hindi !== null;
        const hasAssamese = v.assamese && v.assamese !== null;
        const meaningContent = hasMeaning ? v.meaning : `<a class="translate-btn" href="https://www.google.com/search?q=${encodeURIComponent(v.verb + ' meaning')}" target="_blank">Look up Meaning</a>`;
        const hindiContent = hasHindi ? v.hindi : `<a class="translate-btn" href="https://translate.google.co.in/?text=${encodeURIComponent(v.verb)}&sl=en&tl=hi" target="_blank">Translate to Hindi</a>`;
        const assameseContent = hasAssamese ? v.assamese : `<a class="translate-btn" href="https://translate.google.co.in/?text=${encodeURIComponent(v.verb)}&sl=en&tl=as" target="_blank">Translate to Assamese</a>`;

        const row = document.createElement('tr');
        row.className = 'clickable';
        row.onclick = () => goToVerbDetail(v.verb);
        row.innerHTML = `
          <td>${v.verb}</td>
          <td class="meaning-col">${meaningContent}</td>
          <td class="hindi-col">${hindiContent}</td>
          <td class="assamese-col">${assameseContent}</td>
          <td><span class="action-btn" onclick="event.stopPropagation(); speak('${v.verb}')">🔊</span></td>
          <td><span class="action-btn ${starredVerbs.includes(v.verb) ? 'starred' : ''}" onclick="event.stopPropagation(); toggleStar('${v.verb}')">★</span></td>
        `;
        tbody.appendChild(row);
        const item = document.createElement('div');
        item.className = 'section-item';
        item.onclick = () => goToVerbDetail(v.verb);
        item.innerHTML = `
          <span><strong>Verb:</strong> ${v.verb}</span>
          ${currentLanguage === 'en-only' ? '' : `<span><strong>Meaning:</strong> ${meaningContent}</span>`}
          ${currentLanguage === 'en-only' || currentLanguage === 'en-as' ? '' : `<span><strong>Hindi:</strong> ${hindiContent}</span>`}
          ${currentLanguage === 'en-only' || currentLanguage === 'en-hi' ? '' : `<span><strong>Assamese:</strong> ${assameseContent}</span>`}
          <span><span class="action-btn" onclick="event.stopPropagation(); speak('${v.verb}')">🔊</span></span>
          <span><span class="action-btn ${starredVerbs.includes(v.verb) ? 'starred' : ''}" onclick="event.stopPropagation(); toggleStar('${v.verb}')">★</span></span>
        `;
        sectionContent.appendChild(item);
      });
    }

    // Search Functions
    function searchVerbs() {
      const searchInput = window.innerWidth <= 600 ? document.getElementById('search-verbs-mobile') : document.getElementById('search-verbs');
      const search = searchInput.value.trim();
      const errorElements = [document.getElementById('verbs-error'), document.getElementById('verbs-error-mobile')];
      if (!search) {
        errorElements.forEach(el => {
          el.textContent = 'Please enter a verb to search';
          el.style.display = 'block';
          setTimeout(() => { el.style.display = 'none'; }, 3000);
        });
        return;
      }
      searchInput.value = ''; // Clear input
      renderVerbsTable(search);
    }

    function searchForms() {
      const searchInput = window.innerWidth <= 600 ? document.getElementById('search-forms-mobile') : document.getElementById('search-forms');
      const search = searchInput.value.trim();
      const errorElements = [document.getElementById('forms-error'), document.getElementById('forms-error-mobile')];
      if (!search) {
        errorElements.forEach(el => {
          el.textContent = 'Please enter a verb to search';
          el.style.display = 'block';
          setTimeout(() => { el.style.display = 'none'; }, 3000);
        });
        return;
      }
      searchInput.value = ''; // Clear input
      renderFormsTable(search);
    }

    function searchStarred() {
      const searchInput = document.getElementById('search-starred-mobile');
      const search = searchInput.value.trim();
      const errorElement = document.getElementById('starred-error-mobile');
      if (!search) {
        errorElement.textContent = 'Please enter a verb to search';
        errorElement.style.display = 'block';
        setTimeout(() => { errorElement.style.display = 'none'; }, 3000);
        return;
      }
      searchInput.value = ''; // Clear input
      renderStarredTable(search);
    }

    function searchSaved() {
      const searchInput = document.getElementById('search-saved-mobile');
      const search = searchInput.value.trim();
      const errorElements = [document.getElementById('save-error'), document.getElementById('saved-error-mobile')];
      if (!search) {
        errorElements.forEach(el => {
          el.textContent = 'Please enter a verb to search';
          el.style.display = 'block';
          setTimeout(() => { el.style.display = 'none'; }, 3000);
        });
        return;
      }
      searchInput.value = ''; // Clear input
      renderSavedTable(search);
    }

    // Text-to-Speech
    function speak(text) {
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = 'en-US';
      window.speechSynthesis.speak(utterance);
    }

    function speakAllForms(present, past, participle) {
      const forms = [present, past, participle];
      let index = 0;
      function speakNext() {
        if (index < forms.length) {
          const utterance = new SpeechSynthesisUtterance(forms[index]);
          utterance.lang = 'en-US';
          utterance.onend = () => {
            index++;
            speakNext();
          };
          window.speechSynthesis.speak(utterance);
        }
      }
      speakNext();
    }

    // Toggle Star
    function toggleStar(verb) {
      if (starredVerbs.includes(verb)) {
        starredVerbs = starredVerbs.filter(v => v !== verb);
      } else {
        starredVerbs.push(verb);
      }
      localStorage.setItem('starredVerbs', JSON.stringify(starredVerbs));
      renderTables();
    }

    // Save Verb
    async function saveVerb() {
      const verb = document.getElementById('save-verb').value.trim().toLowerCase();
      const errorElements = [document.getElementById('save-error'), document.getElementById('saved-error-mobile')];
      if (!verb) {
        errorElements.forEach(el => {
          el.textContent = 'Please enter a verb';
          el.style.display = 'block';
          setTimeout(() => { el.style.display = 'none'; }, 3000);
        });
        return;
      }
      if (savedVerbs.includes(verb)) {
        errorElements.forEach(el => {
          el.textContent = 'Verb already saved';
          el.style.display = 'block';
          setTimeout(() => { el.style.display = 'none'; }, 3000);
        });
        return;
      }
      const forms = getVerbForms(verb);
      const baseVerb = forms.base;
      if (verbs.some(v => v.verb === baseVerb)) {
        savedVerbs.push(baseVerb);
        localStorage.setItem('savedVerbs', JSON.stringify(savedVerbs));
        document.getElementById('save-verb').value = '';
        renderSavedTable();
      } else if (fetchedVerbs.some(v => v.verb === baseVerb)) {
        savedVerbs.push(baseVerb);
        localStorage.setItem('savedVerbs', JSON.stringify(savedVerbs));
        document.getElementById('save-verb').value = '';
        renderSavedTable();
      } else {
        const newVerb = await fetchVerb(verb, window.innerWidth <= 600 ? 'saved-mobile' : 'saved');
        if (newVerb) {
          savedVerbs.push(baseVerb);
          localStorage.setItem('savedVerbs', JSON.stringify(savedVerbs));
          document.getElementById('save-verb').value = '';
          renderSavedTable();
        }
      }
    }

    // Initial Render
    renderTables();
  </script>
   <script src="sw.js"></script>
</body>
</html>